<?php
/* <https://www.shielder.com/advisories/pfsense-remote-command-execution/ 
/* if (isset($_REQUEST['isAjax'])) {
/* 	require_once('auth_check.inc');
/* 
/* 	$netstat = "/usr/bin/netstat -rW";
/* 	if (isset($_REQUEST['IPv6'])) {
/* 		$netstat .= " -f inet6";
/* 		echo "IPv6\n";
/*	} else {
/* 		$netstat .= " -f inet";
/* 		echo "IPv4\n";
/* 
/* 	}
/* 	if (!isset($_REQUEST['resolve'])) {
/* 		$netstat .= " -n";
/* 	}
/*
/* 	if (!empty($_REQUEST['filter'])) {
*/
		$netstat .= " | /usr/bin/sed -e " . escapeshellarg("1,3d; 5,\$ { /" . htmlspecialchars($_REQUEST['filter']) . "/!d; };");
/*
/* 	} else {
/* 		$netstat .= " | /usr/bin/sed -e '1,3d'";
/* 	}
/* 
/* 	if (is_numeric($_REQUEST['limit']) && $_REQUEST['limit'] > 0) {
/* 		$_REQUEST['limit']++;  // Account for the header line
/* 		$netstat .= " | /usr/bin/head -n {$_REQUEST['limit']}";
/* 	}
/* 
*/
	echo htmlspecialchars_decode(shell_exec($netstat));
/* 
/* 	exit;
*/
/* ?>
*/